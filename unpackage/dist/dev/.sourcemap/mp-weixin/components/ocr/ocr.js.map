{"version":3,"sources":["webpack:////Users/coderyh/Downloads/ydyyapp/components/ocr/ocr.vue?882c","webpack:////Users/coderyh/Downloads/ydyyapp/components/ocr/ocr.vue?3ae6","webpack:////Users/coderyh/Downloads/ydyyapp/components/ocr/ocr.vue?0105","webpack:////Users/coderyh/Downloads/ydyyapp/components/ocr/ocr.vue?bbc1","uni-app:///components/ocr/ocr.vue","webpack:////Users/coderyh/Downloads/ydyyapp/components/ocr/ocr.vue?9787","webpack:////Users/coderyh/Downloads/ydyyapp/components/ocr/ocr.vue?0d99"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4H;AAC5H;AACuD;AACL;AACsC;;;AAGxF;AAC6M;AAC7M,gBAAgB,iNAAU;AAC1B,EAAE,yEAAM;AACR,EAAE,0FAAM;AACR,EAAE,mGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,8FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,uTAEN;AACP,KAAK;AACL;AACA,aAAa,qPAEN;AACP,KAAK;AACL;AACA,aAAa,kSAEN;AACP,KAAK;AACL;AACA,aAAa,sOAEN;AACP;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AChDA;AAAA;AAAA;AAAA;AAAkzB,CAAgB,iyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACmCt0B,2E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eACA,EACA,eADA,EAEA,SAFA,EAKA,IALA,kBAKA,CACA,SACA,OADA,EAEA;AACA,iBAHA,EAIA;AACA,mBALA,EAMA,gBANA,EAOA,aAPA,EAQA,aARA,GAUA,CAhBA,EAiBA,OAjBA,qBAiBA,CACA,yDACA,oDACA,cACA,+CADA,EAEA,QACA,kCADA,EAEA,uCAFA,EAEA;AACA,6DAHA,CAGA;AAHA,SAFA,EAOA,cAPA,EAQA,UACA,mDADA,EARA,EAWA,gCACA;AACA,sCACA,4CACA,sDACA,CACA,CAjBA;AAmBA;;AAEA;AACA;AACA;AACA,OAFA,CAEA,IAFA,CAEA,IAFA,CADA;;AAKA,GA9CA;AA+CA;AACA,eADA,yBACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBADA,EACA;AACA,kCAFA;AAGA;AACA;AACA,6BADA;;AAGA,6CAJA,CAIA;AACA;AACA;AACA,uCADA;AAEA,uCAFA;AAGA,2BAHA;AAIA,uBAJA;;AAMA;AACA;AACA;AACA,6CADA,CACA;AACA;AACA,2CADA;;AAGA;AACA,aANA;AAOA;AACA;AACA,WAjBA;AAkBA;AACA;AACA,WApBA;;AAsBA,SA/BA;AAgCA;AACA;AACA;AACA;AACA,+BADA;AAEA,kCAFA;;AAIA,aALA,MAKA;AACA;AACA,+BADA;AAEA,kCAFA;;AAIA;AACA;AACA;AACA,uBADA,mBACA,GADA,EACA;AACA;AACA,iBAHA;;AAKA,aANA,EAMA,IANA;AAOA;AACA,SArDA;;AAuDA,KArEA;AAsEA,aAtEA,qBAsEA,MAtEA,EAsEA;AACA;AACA,kHADA;AAEA,oBAFA;AAGA,sBAHA;AAIA;AACA,6DADA,EAJA;;AAOA;AACA;AACA;AACA;AACA;AACA,2BADA;AAEA,0CAFA;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SA3BA;AA4BA;AACA;AACA,SA9BA;;AAgCA,KAvGA;AAwGA;AACA,gBAzGA,wBAyGA,IAzGA,EAyGA,GAzGA,EAyGA;AACA;AACA;AACA;AACA;AACA,SAFA;AAGA;AACA;AACA,uBADA;AAEA,6CAFA;;;AAKA;AACA,KAtHA;AAuHA;AACA,kBAxHA,0BAwHA,IAxHA,EAwHA,UAxHA,EAwHA,SAxHA,EAwHA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAFA;;AAIA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kDADA,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAHA,MAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAXA;AAYA;AACA,OAnBA;;AAqBA;AACA;;AAEA,kBA1DA,CA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAFA,CAEA;AACA,8DAHA,CAGA;AACA,4BAJA,CAIA;AACA;AACA;AACA,SARA;AASA;AACA;AACA;AACA;AACA,OAfA;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA3NA;AA4NA;AACA,gBA7NA,wBA6NA,SA7NA,EA6NA,SA7NA,EA6NA;AACA;AACA,2BADA;AAEA,0BAFA;AAGA,qBAHA;AAIA,oBAJA;AAKA;AACA,oBADA;AAEA,sBAFA;AAGA,sBAHA,GALA;;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA;AAGA;AACA,gEADA;AAEA,8CAFA;AAGA,4CAHA;;AAKA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAtQA;AAuQA;AACA,WAxQA,mBAwQA,GAxQA,EAwQA,KAxQA,EAwQA;AACA;AACA,KA1QA;AA2QA,UA3QA,oBA2QA;AACA;AACA,KA7QA;AA8QA,cA9QA,wBA8QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA5RA,EA/CA,E;;;;;;;;;;;;;ACpCA;AAAA;AAAA;AAAA;AAA6hD,CAAgB,w7CAAG,EAAC,C;;;;;;;;;;;ACAjjD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/ocr/ocr.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./ocr.vue?vue&type=template&id=510f0ac2&scoped=true&\"\nvar renderjs\nimport script from \"./ocr.vue?vue&type=script&lang=js&\"\nexport * from \"./ocr.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ocr.vue?vue&type=style&index=0&id=510f0ac2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"510f0ac2\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/ocr/ocr.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ocr.vue?vue&type=template&id=510f0ac2&scoped=true&\"","var components\ntry {\n  components = {\n    uniIcons: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    },\n    wybTable: function() {\n      return import(\n        /* webpackChunkName: \"components/wyb-table/wyb-table\" */ \"@/components/wyb-table/wyb-table.vue\"\n      )\n    },\n    uButton: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-button/u-button\" */ \"uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n    uToast: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-toast/u-toast\" */ \"uview-ui/components/u-toast/u-toast.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ocr.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ocr.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"box-compents\">\r\n\t\t<view class=\"status-bar\"></view>\r\n\t\t<view class=\"nav-bar\">\r\n\t\t\t<view class=\"left\">\r\n\t\t\t\t<view class=\"navleftview\">\r\n\t\t\t\t\t<uni-icons type=\"back\" size=\"30\" color=\"#fff\" @tap=\"toback\"></uni-icons>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"center\">OCR表格识别</view>\r\n\t\t\t<view class=\"right\"></view>\r\n\t\t</view>\r\n\t\t<view class=\"box-compents-con\">\r\n\r\n\t\t\t<!-- :first-line-fixed=\"true\" @longPress=\"longPress\" -->\r\n\t\t\t<wyb-table class=\"wyb-table\" :headers=\"tableHead\" :contents=\"tableBody\" :height=\"tableH\"\r\n\t\t\t\t:defaultColWidth=\"300\" @dele=\"rowDele\" v-if=\"tableShow\" />\r\n\r\n\t\t</view>\r\n\t\t<view class=\"my-primary-button sticky-bottom\">\r\n\t\t\t<u-button type=\"primary\" class=\"my-primary-button\" text=\"选取图片识别\" throttleTime=\"1000\" @tap=\"uploadImage\"\r\n\t\t\t\tstyle=\"margin-bottom:10px;\">\r\n\t\t\t</u-button>\r\n\t\t\t<u-button type=\"primary\" class=\"my-primary-button\" text=\"上传\" throttleTime=\"1000\" v-if=\"tableShow\"\r\n\t\t\t\t@tap=\"uploadData\">\r\n\t\t\t</u-button>\r\n\t\t</view>\r\n\r\n\t\t<u-toast ref=\"uToast\"></u-toast>\r\n\r\n\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport dayjs from \"dayjs\";\r\n\texport default {\r\n\t\tname: \"OCRText\",\r\n\t\tprops: {\r\n\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tsrc: \"\",\r\n\t\t\t\t//表格处理数组\r\n\t\t\t\tArrData: [],\r\n\t\t\t\t//表格\r\n\t\t\t\ttableH: \"0px\",\r\n\t\t\t\ttableShow: false,\r\n\t\t\t\ttableHead: [],\r\n\t\t\t\ttableBody: [],\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tlet newDate = dayjs().format(\"YYYY-MM-DD\")\r\n\t\t\tif (newDate != uni.getStorageSync(\"OcrTokenDate\")) {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: \"https://aip.baidubce.com/oauth/2.0/token\",\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\"grant_type\": \"client_credentials\",\r\n\t\t\t\t\t\t\"client_id\": \"8iaqLe0byhX5xKIE0A8fxxWi\", //百度表格文字 应用的API Key\r\n\t\t\t\t\t\t\"client_secret\": \"dVg1ZSTHQh0f3Oxz4YktprrpNdA0bQH1\" //百度表格文字 应用的Secret Key\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\"Content-Type\": \"application/x-www-form-urlencoded\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t// console.log(\"OcrToken res\",res)\r\n\t\t\t\t\t\tif (res.statusCode == 200) {\r\n\t\t\t\t\t\t\tuni.setStorageSync(\"OcrTokenDate\", newDate);\r\n\t\t\t\t\t\t\tuni.setStorageSync(\"OcrToken\", res.data.access_token);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuni.getSystemInfo({\r\n\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\tthis.tableH = res.screenHeight - res.statusBarHeight - 54 + \"px\"\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tuploadImage() {\r\n\t\t\t\tthis.tableHead = []\r\n\t\t\t\tthis.tableBody = []\r\n\t\t\t\tlet sourceTypeTemp=[]\r\n\t\t\t\tif(uni.getStorageSync(\"isCamera\")&&uni.getStorageSync(\"isAlbum\")){\r\n\t\t\t\t\tsourceTypeTemp=['camera','album']\r\n\t\t\t\t}\r\n\t\t\t\tif(uni.getStorageSync(\"isCamera\")==true&&uni.getStorageSync(\"isAlbum\")==false){\r\n\t\t\t\t\tsourceTypeTemp=['camera']\r\n\t\t\t\t}\r\n\t\t\t\tif(uni.getStorageSync(\"isCamera\")==false&&uni.getStorageSync(\"isAlbum\")==true){\r\n\t\t\t\t\tsourceTypeTemp=['album']\r\n\t\t\t\t}\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 1, //默认9\r\n\t\t\t\t\tsourceType: sourceTypeTemp,\r\n\t\t\t\t\tsuccess: (resup) => {\r\n\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\ttitle: \"正在识别中...\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.src = resup.tempFilePaths[0]; //后面还能用到 src 暂且留着\r\n\t\t\t\t\t\t// 下面进行转码\r\n\t\t\t\t\t\tplus.zip.compressImage({\r\n\t\t\t\t\t\t\t\tsrc: resup.tempFilePaths[0],\r\n\t\t\t\t\t\t\t\tdst: resup.tempFilePaths[0],\r\n\t\t\t\t\t\t\t\toverwrite: true,\r\n\t\t\t\t\t\t\t\tquality: 40\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tzipRes => {\r\n\t\t\t\t\t\t\t\tvar reader = new plus.io.FileReader();\r\n\t\t\t\t\t\t\t\treader.onloadend = res => {\r\n\t\t\t\t\t\t\t\t\tvar speech = res.target.result; //base64图片\r\n\t\t\t\t\t\t\t\t\tlet dataes = {\r\n\t\t\t\t\t\t\t\t\t\timage: speech.split(\",\")[1]\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis.toOcrText(dataes)\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t//一定要使用plus.io.convertLocalFileSystemURL将target地址转换为本地文件地址，否则readAsDataURL会找不到文件\r\n\t\t\t\t\t\t\t\treader.readAsDataURL(plus.io.convertLocalFileSystemURL(zipRes.target));\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t(error) => {\r\n\t\t\t\t\t\t\t\tconsole.log(\"Compress error!\", error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tif(err.errMsg.indexOf(\"No Permission\")>-1){\r\n\t\t\t\t\t\t\tif(err.errCode==11){\r\n\t\t\t\t\t\t\t\tthis.$refs.uToast.show({\r\n\t\t\t\t\t\t\t\t\ttype: \"default\",\r\n\t\t\t\t\t\t\t\t\tmessage: \"请打开相机权限\"\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}else if(err.errCode==12){\r\n\t\t\t\t\t\t\t\tthis.$refs.uToast.show({\r\n\t\t\t\t\t\t\t\t\ttype: \"default\",\r\n\t\t\t\t\t\t\t\t\tmessage: \"请打开存储权限\"\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\t\t\tuni.openAppAuthorizeSetting({\r\n\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\t// console.log(\"uni.openAppAuthorizeSetting res\", res)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t},1900)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\ttoOcrText(dataes) {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: `https://aip.baidubce.com/rest/2.0/ocr/v1/table?access_token=${uni.getStorageSync(\"OcrToken\")}`,\r\n\t\t\t\t\tdata: dataes,\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\"Content-Type\": \"application/x-www-form-urlencoded\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log(\"toOcrText 图片识别结果\", res)\r\n\t\t\t\t\t\t//未识别到表格\r\n\t\t\t\t\t\tif (res.statusCode != 200 || res.data.table_num == 0) {\r\n\t\t\t\t\t\t\tthis.$refs.uToast.show({\r\n\t\t\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\t\t\tmessage: \"识别错误(表格不清晰或错误的表格)\"\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//多表格情况\r\n\t\t\t\t\t\tif (res.data.table_num > 1) {\r\n\t\t\t\t\t\t\tthis.TablesBottom(res.data, res.data.tables_num)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//识别成功\r\n\t\t\t\t\t\tif (res.data.tables_result.length != 0) {\r\n\t\t\t\t\t\t\tfor (let x = 0; x <= res.data.table_num - 1; x++) {\r\n\t\t\t\t\t\t\t\tthis.ProcessingData(res.data.tables_result[x].body, x, res.data.table_num - 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: (lete) => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//判断多表格值是否正确\r\n\t\t\tTablesBottom(data, Num) {\r\n\t\t\t\tlet Errortable\r\n\t\t\t\tfor (let x = 0; x < Num; x++) {\r\n\t\t\t\t\tErrortable = data.tables_result[x].body.filter(item => {\r\n\t\t\t\t\t\treturn item.words.search(\"\\n\") != -1\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.log(\"Errortable\", Errortable)\r\n\t\t\t\t\tErrortable.length == 0 ? \"\" : this.$refs.uToast.show({\r\n\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\tmessage: \"识别多表格可能有误，请检查或双击修改错误的行数据\"\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//计算识别数据转化为表格\r\n\t\t\tProcessingData(data, tableindex, tableNumS) {\r\n\t\t\t\t// data\t表格数据\r\n\t\t\t\t// tableindex\t第几个表格\r\n\t\t\t\t// tableNumS\t第几个表格\r\n\r\n\t\t\t\t//删除合计\r\n\t\t\t\t// data.filter((item, index) => {\r\n\t\t\t\t// \tif (item.words == \"合计\") {\r\n\t\t\t\t// \t\tdata.splice(index, 1)\r\n\t\t\t\t// \t}\r\n\t\t\t\t// })\r\n\t\t\t\t\r\n\t\t\t\tfor(var j in data){\r\n\t\t\t\t\tif(data[j].words==\"\"){\r\n\t\t\t\t\t\tdata.splice(j,1)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet col = data.filter((item) => {\r\n\t\t\t\t\treturn item.row_start === 0;\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// 表格头列数\r\n\t\t\t\tlet TableNum = col.length;\r\n\r\n\t\t\t\t//确定表头\r\n\t\t\t\tlet Arrset = []\r\n\t\t\t\tfor (let i = 0; i < TableNum; i++) {\r\n\t\t\t\t\t// if(data[i].words!=\"\"){\r\n\t\t\t\t\t\tArrset.push(data[i]);\r\n\t\t\t\t\t// }\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//表头\\n错误处理\r\n\t\t\t\tArrset.filter((item, index) => {\r\n\t\t\t\t\tif (item.words.search(\"\\n\") != -1) {\r\n\t\t\t\t\t\tlet intercept = item.words.split(\"\\n\") //字符串截取\r\n\t\t\t\t\t\t// console.log(\"intercept :>> \", intercept);\r\n\t\t\t\t\t\tlet regChinese = /^[\\u4e00-\\u9fa5]+$/;\r\n\t\t\t\t\t\tlet regChinBol=false\r\n\t\t\t\t\t\tintercept.forEach((v,i,arr)=>{\r\n\t\t\t\t\t\t\tif(regChinese.test(v)){\r\n\t\t\t\t\t\t\t\tregChinBol=true\r\n\t\t\t\t\t\t\t\tArrset[index].words = intercept[i]\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tif(i==arr.length-1){\r\n\t\t\t\t\t\t\t\t\tif(!regChinBol){\r\n\t\t\t\t\t\t\t\t\t\tArrset[index].words = intercept[0]\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\t//表头赋值\r\n\t\t\t\tlet tableHead = Array.from(new Set(Arrset))\r\n\t\t\t\t\r\n\t\t\t\tArrset = []; //清楚处理表头数据\r\n\t\t\t\t//处理表格数据\r\n\t\t\t\tlet obj = {};\r\n\t\t\t\tfor (let x = TableNum; x < data.length; x++) {\r\n\t\t\t\t\tlet index = x % TableNum;\r\n\t\t\t\t\tlet test = tableHead[index].words\r\n\t\t\t\t\tobj[test] = data[x].words;\r\n\t\t\t\t\tif ((x + 1) % TableNum == 0 && x > TableNum) {\r\n\t\t\t\t\t\tthis.ArrData.push(obj);\r\n\t\t\t\t\t\tobj = {};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//表格\\n错误处理\r\n\t\t\t\tlet intercept;\r\n\t\t\t\tlet ErrorData = {};\r\n\t\t\t\tlet TableBol = false;\r\n\t\t\t\tthis.ArrData.filter((item, index) => {\r\n\t\t\t\t\tlet ChangeArr = Object.keys(item)\r\n\t\t\t\t\tChangeArr.filter(((temp, Tempindex) => {\r\n\t\t\t\t\t\tif (item[temp].search(\"\\n\") != -1) {\r\n\t\t\t\t\t\t\tintercept = item[temp].split(\"\\n\")\r\n\t\t\t\t\t\t\tthis.ArrData[index][temp] = intercept[intercept.length - 2]; //截取前半部分给值\r\n\t\t\t\t\t\t\tErrorData[temp] = intercept[intercept.length - 1] //后半部分添加新的一行\r\n\t\t\t\t\t\t\tTableBol = true //是否有错误\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tintercept = \"\"\r\n\t\t\t\t\t}))\r\n\t\t\t\t\tif (TableBol) {\r\n\t\t\t\t\t\tthis.ArrData.push(ErrorData)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tTableBol = false\r\n\t\t\t\t})\r\n\t\t\t\t// //表格赋值\r\n\t\t\t\tlet tableBody = this.ArrData\r\n\t\t\t\t// console.log(\"开始转化表头 tableHead\", tableHead)\r\n\t\t\t\t// console.log(\"开始转化表中数据 tableBody\", tableBody)\r\n\t\t\t\tif (tableindex == tableNumS) {\r\n\t\t\t\t\tthis.OCRTableData(tableHead, tableBody);\r\n\t\t\t\t\tthis.ArrData = []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//识别数据格式转成表格数据格式\r\n\t\t\tOCRTableData(tableHead, tableBody) {\r\n\t\t\t\tthis.tableHead.push({\r\n\t\t\t\t\t\"type\": \"operation\",\r\n\t\t\t\t\t\"key\": \"operation\",\r\n\t\t\t\t\t\"label\": \"操作\",\r\n\t\t\t\t\t\"width\": 260,\r\n\t\t\t\t\t\"renders\": [{\r\n\t\t\t\t\t\tname: \"删除\",\r\n\t\t\t\t\t\ttype: \"warn\",\r\n\t\t\t\t\t\tfunc: \"dele\"\r\n\t\t\t\t\t}]\r\n\t\t\t\t})\r\n\t\t\t\tfor (let i = 0; i < tableHead.length; i++) {\r\n\t\t\t\t\tlet numArr = []\r\n\t\t\t\t\tfor (var m in tableHead[i].cell_location) {\r\n\t\t\t\t\t\tnumArr.push(tableHead[i].cell_location[m].x)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnumArr.sort(function(a, b) {\r\n\t\t\t\t\t\treturn a - b;\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.tableHead.push({\r\n\t\t\t\t\t\twidth: Math.abs(numArr[0] - numArr[numArr.length - 1]),\r\n\t\t\t\t\t\tlabel: `${tableHead[i].words}`,\r\n\t\t\t\t\t\tkey: `${tableHead[i].words}`\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tthis.tableBody = tableBody;\r\n\r\n\t\t\t\t// //识别后可修改数据，添加slot\r\n\t\t\t\t// for (let x = 0; x < Head.length; x++) {\r\n\t\t\t\t// \tswitch (Head[x].key) {\r\n\t\t\t\t// \t\tcase \"进价\":\r\n\t\t\t\t// \t\tcase \"bzs \":\r\n\t\t\t\t// \t\tcase \"入库数量\":\r\n\t\t\t\t// \t\t\tHead[x].slot = Head[x].key\r\n\t\t\t\t// \t\t\tbreak;\r\n\t\t\t\t// \t}\r\n\t\t\t\t// }\r\n\t\t\t\tconsole.log(\"this.tableHead=================\", this.tableHead)\r\n\t\t\t\tconsole.log(\"this.tableBody=================\", this.tableBody)\r\n\t\t\t\tthis.tableShow = true\r\n\t\t\t},\r\n\t\t\t// 表格操作\r\n\t\t\trowDele(row, index) {\r\n\t\t\t\tthis.tableBody.splice(index, 1)\r\n\t\t\t},\r\n\t\t\ttoback() {\r\n\t\t\t\tthis.$emit(\"ocrBack\")\r\n\t\t\t},\r\n\t\t\tuploadData() {\r\n\t\t\t\t// this.uploadarr.push({\r\n\t\t\t\t// \t\"bzjzrq\": dayjs().date(dayjs().date() + this.serchGoodsData.bzqts).format(\"YYYY-MM-DD\"),\r\n\t\t\t\t// \t\"cgjg\": this.uFormModel.jycgjg,\r\n\t\t\t\t// \t\"cgsl\": this.uFormModel.jycgsl,\r\n\t\t\t\t// \t\"cxtype\": this.uFormModel.jgcxbz.indexOf(\"-\") > -1 ? this.uFormModel.jgcxbz.split(\"-\")[0] :\r\n\t\t\t\t// \t\tthis.uFormModel.jgcxbz,\r\n\t\t\t\t// \t\"guid\": \"\",\r\n\t\t\t\t// \t\"scrq\": dayjs().format(\"YYYY-MM-DD\"),\r\n\t\t\t\t// \t\"spbm\": this.uFormModel.spbm,\r\n\t\t\t\t// \t\"splx\": this.uFormModel.splx?\"T\":\"F\",\r\n\t\t\t\t// \t\"spsl\": this.serchGoodsData.sl,\r\n\t\t\t\t// \t\"spsmm\": this.uFormModel.spsmm\r\n\t\t\t\t// })\r\n\t\t\t}\r\n\r\n\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.box-compents {\r\n\t\twidth: 100%;\r\n\t\theight: 100vh;\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tz-index: 6000;\r\n\t\tbackground-color: #fff;\r\n\r\n\t\t.status-bar {\r\n\t\t\tbackground-image: linear-gradient(to right, var(--nav-left-color), var(--nav-center-color), var(--nav-right-color));\r\n\t\t}\r\n\r\n\t\t.nav-bar {\r\n\t\t\tbackground-image: linear-gradient(to right, var(--nav-left-color), var(--nav-center-color), var(--nav-right-color));\r\n\t\t}\r\n\r\n\t\t.box-compents-con {\r\n\t\t\tpadding-top: calc(var(--status-bar-height) + 46px);\r\n\t\t\tpadding-left: 8px;\r\n\t\t\tpadding-right: 8px;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\t}\r\n</style>\n","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ocr.vue?vue&type=style&index=0&id=510f0ac2&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ocr.vue?vue&type=style&index=0&id=510f0ac2&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1677116520050\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}